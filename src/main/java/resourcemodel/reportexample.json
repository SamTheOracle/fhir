{
  "aggregationOutputFields": [],
  "pipeline": [
    {
      "$match": {
        "$expr": {
          "$and": [
            {
              "$or": [
                {
                  "$or": [
                    {
                      "$regexMatch": {
                        "input": "$code.text",
                        "regex": "gay",
                        "options": "i"
                      }
                    },
                    {
                      "$regexMatch": {
                        "input": {
                          "$reduce": {
                            "input": "$code.coding",
                            "initialValue": "",
                            "in": {
                              "$concat": [
                                "$$value",
                                "$$this.code",
                                " ",
                                "$$this.display",
                                " "
                              ]
                            }
                          }
                        },
                        "regex": "gay",
                        "options": "i"
                      }
                    }
                  ]
                },
                {}
              ]
            },
            {}
          ]
        }
      }
    }
  ],
  "cursor": {},
  "allowDiskUse": true
}
