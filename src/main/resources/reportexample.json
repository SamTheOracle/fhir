{
  "pipeline": [
    {
      "$match": {
        "$expr": {
          "$and": [
            {
              "$or": [
                {
                  "$regexMatch": {
                    "input": "$code.text",
                    "regex": "4171630326",
                    "options": "i"
                  }
                },
                {
                  "$regexMatch": {
                    "input": {
                      "$reduce": {
                        "input": "$code.coding",
                        "initialValue": "",
                        "in": {
                          "$concat": [
                            "$$value",
                            "$$this.code",
                            " ",
                            "$$this.display",
                            " "
                          ]
                        }
                      }
                    },
                    "regex": "4171630326",
                    "options": "i"
                  }
                }
              ]
            },
            {}
          ]
        }
      }
    }
  ],
  "cursor": {},
  "allowDiskUse": true,
  "aggregate": "conditions"
}
