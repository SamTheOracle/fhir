{
  "aggregationOutputFields": [],
  "pipeline": [
    {
      "$match": {
        "$expr": {
          "$eq": [
            false,
            {
              "$in": [
                "DELETED",
                {
                  "$ifNull": [
                    "$meta.tag",
                    []
                  ]
                }
              ]
            }
          ]
        }
      }
    },
    {
      "$match": {
        "$expr": {
          "$and": [
            {
              "$or": [
                {
                  "$regexMatch": {
                    "input": "$code.text",
                    "regex": "12345",
                    "options": "i"
                  }
                },
                {
                  "$regexMatch": {
                    "input": {
                      "$reduce": {
                        "input": "$code.coding",
                        "initialValue": "",
                        "in": {
                          "$concat": [
                            "$$value",
                            "$$this.code",
                            " ",
                            "$$this.display",
                            " "
                          ]
                        }
                      }
                    },
                    "regex": "12345",
                    "options": "i"
                  }
                }
              ]
            },
            {}
          ]
        }
      }
    }
  ],
  "cursor": {},
  "allowDiskUse": true
}
